{"componentChunkName":"component---src-components-blog-post-js","path":"/problem/icpc/asia_jakarta_2018/C","result":{"data":{"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"é¡Œç›®æ•˜è¿°"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"showvariable","properties":{"varname":"description"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"è¼¸å…¥èªªæ˜"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"è¼¸å…¥åŒ…å« 3 å€‹æ•´æ•¸ $N, M, K$ï¼ˆ$1\\le N\\le 100000, 1\\le M\\le 10, 1\\le K\\le \\min(M^N, 100000)$ï¼‰ï¼Œä¾åºä»£è¡¨å¯†ç¢¼çš„é•·åº¦ã€èƒ½å¤ éµå…¥çš„æ•¸å­—ç¨®é¡ã€é‚„æœ‰ç¬¬ä¸€å¤©æƒ³è¦æ¸¬è©¦çš„å¯†ç¢¼é‡ã€‚è¼¸å…¥çš„ç¬¬äºŒåˆ—åŒ…å« $M$ å€‹æ•´æ•¸ï¼š$A_i (0\\le A_i\\le 9)$ è¡¨ç¤ºèƒ½å¤ ä½¿ç”¨çš„æ•¸å­—å€‘ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ä½ å¯ä»¥å‡è¨­è¼¸å…¥çš„ $N, M, K$ æœƒä½¿å¾—ç­”æ¡ˆå­—ä¸²ä¸è¶…é $100000$ ä½æ•¸ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"è¼¸å‡ºèªªæ˜"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"è¼¸å‡ºä»»ä½•ä¸€å€‹æ»¿è¶³æ¢ä»¶çš„ã€æœ€çŸ­çš„å­—ä¸² $S$ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å…¥ 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"3 2 5\n4 7\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å‡º 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"7477447\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å…¥ 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"2 5 9\n1 2 3 4 5\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å‡º 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"1234554321\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å…¥ 3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"6 3 2\n9 3 5\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¯„ä¾‹è¼¸å‡º 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"9353593\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"OJ é€£çµ"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://codeforces.com/gym/102001/problem/C"},"children":[{"type":"text","value":"Codeforces Gym 102001 - C"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"è§£æ³•"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"é¦–å…ˆï¼Œè¼¸å…¥çš„ $A_i$ è·Ÿç­”æ¡ˆä¸€é»é—œä¿‚ä¹Ÿæ²’æœ‰ï¼Œå› æ­¤æˆ‘å€‘ç¸½æ˜¯å¯ä»¥å‡è¨­é€™äº›æ•¸å­—æ˜¯ $0, 1, \\ldots, M-1$ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"é€™é¡Œçš„é—œéµå­—åªæœ‰ä¸€å€‹ï¼Œå°±æ˜¯ "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/De_Bruijn_sequence"},"children":[{"type":"text","value":"De Bruijn Sequence"}]},{"type":"text","value":"ã€‚å°æ–¼çµ¦å®šçš„åƒæ•¸ $n, m$ ä¾†èªªï¼ŒDe Bruijn Sequence $B(n, m)\\in [m]^n$ æ˜¯ä¸€å€‹é•·åº¦ç‚º $n^m$ çš„åºåˆ—ï¼ŒæŠŠä»–æ¥æˆä¸€åœˆä»¥å¾Œï¼Œä»»ä½•é€£çºŒçš„ $n$ å€‹å­—å…ƒéƒ½ä¸ç›¸åŒã€‚å¾é€™å€‹åºåˆ—çš„å­˜åœ¨æ€§ä¾†èªªï¼Œæˆ‘å€‘å°±å¯ä»¥æ–·å®šæœ¬é¡Œçš„ç­”æ¡ˆé•·åº¦ä¸€å®šæ˜¯ $|S|=K+N-1$ã€‚æ‰€ä»¥å›‰ï¼Œå°æ–¼è¼¸å…¥çš„ $N, M, K$ï¼Œç­”æ¡ˆä¹‹ä¸€å°±å¯ä»¥æ˜¯ $B(N, M)$ æ¥æˆä¸€åœˆä»¥å¾Œçš„ä»»ä½•é•·åº¦ç‚º $K+N-1$ çš„å­å­—ä¸²ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¬¬ä¸€ç¨®è§£æ³•ï¼šä¸€ç­†ç•«å•é¡Œ Eulerian Path"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"å¸¸è¦‹çš„å»ºæ§‹ De Bruijn Sequence æœ‰å…©ç¨®ã€‚ç¬¬ä¸€ç¨®æ˜¯å°‡é€™å€‹é¡Œç›®è½‰åŒ–æˆ"},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Eulerian_path"},"children":[{"type":"text","value":"ä¸€ç­†ç•«å•é¡Œ"}]},{"type":"text","value":"ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºï¼ˆåœ–ç‰‡åƒè€ƒè‡ªç¶­åŸºç™¾ç§‘ï¼‰ï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/De_bruijn_graph-for_binary_sequence_of_order_4.svg/800px-De_bruijn_graph-for_binary_sequence_of_order_4.svg.png","style":"max-width: 300px"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"å¾ä»»ä½•ä¸€é»å‡ºç™¼ï¼Œç„¶å¾Œèµ°éæ‰€æœ‰çš„é‚Šæ°å¥½å¯ä»¥æ¥å‡ºä¸€å€‹ $B(2, 4)$ã€‚æˆ‘å€‘å¯ä»¥"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"åˆ©ç”¨ DFS è§£ä¸€ç­†ç•«å•é¡Œ"}]},{"type":"text","value":"ã€‚ç”±æ–¼é€™å€‹åœ–å¾ˆå¤§ï¼ˆä¸Šé¢æœƒæœ‰ $2^{N-1}$ å€‹ç¯€é»ï¼‰ï¼Œæ‰€ä»¥æˆ‘å€‘ä¸å¯èƒ½æŠŠæ•´å¼µåœ–ç”Ÿå‡ºä¾†å†è·‘ä¸€ç­†ç•«æ¼”ç®—æ³•ï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"åœ¨ DFS éç¨‹ä¸­ï¼Œå¦‚æœæ·±åº¦åˆ°é” $K$ï¼Œé‚£ä¾å¾ª DFS çš„è·¯å¾‘å°±å¯ä»¥æ‰¾åˆ°æƒ³è¦çš„ sequenceã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"åœ¨ DFS éç¨‹ä¸­ï¼Œå¦‚æœèµ°è¨ªå®Œç•¢çš„é‚Šæ•¸åˆ°é” $K$ æ¢ï¼Œé‚£é€™ $K$ æ¢é‚Šä¹Ÿå¯ä»¥æ¥æˆä¸€å€‹ç†æƒ³çš„ sequenceã€‚"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ç”±æ–¼ DFS æ¼”ç®—æ³•æ¯ä¸€æ­¥è¦å˜›èµ°è¨ªä¸€æ¢æ–°çš„é‚Šã€æˆ–æ˜¯æ²¿è‘—ä¸€æ¢é‚Šå›æº¯ï¼ˆä¸¦æŠŠé€™æ¢é‚Šä¸Ÿé€² stackï¼‰ï¼Œæˆ‘å€‘å¾ˆç¢ºå®šæœ€å¤šåªè¦èµ°è¨ª $2K$ æ¢é‚Šå°±å¯ä»¥ä¸­æ­¢æˆ‘å€‘çš„æ¼”ç®—æ³•ã€‚åˆ¤æ–·ä¸€æ¢é‚Šè¢«èµ°éèˆ‡å¦ï¼Œæœ‰å…©ç¨®æ–¹å¼ï¼šæŠŠæ¯æ¢é‚Šé›œæ¹Šä»¥å¾Œå­˜èµ·ä¾†ã€æˆ–æ˜¯æŠŠæ¯å€‹é»é›œæ¹Šä»¥å¾Œï¼Œæ˜ è‡³ç•¶å‰é‚„æœ‰å“ªäº›é‚Šæ²’èµ°éï¼ˆæ˜¯ä¸€å€‹ $0$ åˆ° $M-1$ ä¹‹é–“çš„æ•¸å­—ï¼‰ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"æ‰€ä»¥æœ¬é¡Œå¯ä»¥åœ¨ $O(K)$ æ¬¡é›œæ¹Šå­˜å–çš„æ™‚é–“è¢«è§£æ±ºã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"ç¬¬äºŒç¨®è§£æ³•ï¼šåˆ©ç”¨æ—ç™»å­—ä¸² Lyndon Words"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Roger_Lyndon"},"children":[{"type":"text","value":"Roger Lyndon"}]},{"type":"text","value":" æ˜¯ç¾åœ‹å¯†è¥¿æ ¹å¤§å­¸çš„æ•¸å­¸ç³»æ•™æˆï¼Œä»–åœ¨ 1954 å¹´çš„æ™‚å€™åšäº†ä¸€äº›æœ€å°æ—‹è½‰å­—å…¸åºå­—ä¸²çš„ç›¸é—œç ”ç©¶ï¼ˆä¸»è¦æ˜¯è¨ˆæ•¸æ–¹é¢ï¼‰ã€‚å¦‚æœä¸€å€‹å­—ä¸² $S$ï¼Œæ»¿è¶³ä»¥ä¸‹å…©å€‹ç‰¹å¾µï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"éå¾ªç’°å­—ä¸²ï¼šæ‰¾ä¸åˆ°å¦ä¸€å€‹å­—ä¸² $P$ å’Œæ•´æ•¸ $k>1$ ä½¿å¾— $S=\\underbrace{PP\\cdots P}_k$"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"$S$ æ˜¯æ‰€æœ‰ $S$ çš„æ—‹è½‰å­—ä¸²ä¸­å­—å…¸é †åºæœ€å°çš„ã€‚"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"é‚£éº¼è©²å­—ä¸² $S$ å°±æ˜¯ä¸€å€‹ Lyndon wordã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ï¼ˆé¡Œå¤–è©±â€”â€”èªªåˆ°æ—‹è½‰å­—ä¸²èˆ‡å­—å…¸åºï¼Œå¤§å®¶å¯èƒ½æƒ³åˆ°çš„å°±æ˜¯ Burrows-Wheeler è½‰æ›ï¼Œé€™é¡å‹è³‡æ–™å£“ç¸®çš„æŠ€å·§èˆ‡ Lyndon Word æœ‰è‘—å¯†åˆ‡é—œè¯ã€‚ï¼‰"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"å„˜ç®¡æ—©åœ¨ 1934 å¹´ï¼ŒM. H. Martinï¼ˆæˆ‘æŸ¥ä¸åˆ°æ˜¯èª°ï¹ï¼‰å°±ç”¨äº†é¡ä¼¼ Lyndon word çš„æ–¹æ³•åšå‡ºäº† De Bruijn Sequenceï¼Œä½†ç›´åˆ° 1978 å¹´æ‰ç”± Harold Fredericksen å’Œ James Maiorana å…©ä½ç™¼ç¾ä»¥ä¸‹é©šäººçš„äº‹å¯¦ï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"theorem","properties":{},"children":[{"type":"text","value":"\næŠŠæ‰€æœ‰é•·åº¦æ•´é™¤ $n$ çš„ Lyndon wordsï¼Œä¾ç…§å­—å…¸é †åºï¼ˆæ³¨æ„ä¸æ˜¯é•·åº¦ï¼‰æ’åºå¾Œï¼Œå…¨éƒ¨æ¥èµ·ä¾†ï¼Œå°±å¾—åˆ°ä¸€å€‹ de Bruijn åºåˆ—äº†ï¼\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ä¸‹é¢é€™å€‹æ¼”ç®—æ³•æ˜¯ä½¿ç”¨ç¬¬äºŒç¨®è§£æ³•è£½ä½œçš„ï¼š"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"ä¾ç…§å­—å…¸é †åº"}]},{"type":"text","value":"ç”¢ç”Ÿæ‰€æœ‰é•·åº¦æ•´é™¤ $n$ çš„ Lyndon wordsï¼Œç›´åˆ°æˆ‘å€‘éœ€è¦çš„é•·åº¦ç‚ºæ­¢ã€‚ç‚ºäº†è§£é‡‹ä¸‹é¢çš„ç¨‹å¼ç¢¼ï¼Œæˆ‘å€‘åˆ©ç”¨é—œæ–¼ Lyndon word æ—‹è½‰å­—å…¸åºæœ€å°çš„æ€§è³ªï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"theorem","properties":{},"children":[{"type":"text","value":"\nå¦‚æœå­—ä¸² $S$ æ˜¯ä¸€å€‹ Lyndon wordï¼Œé‚£éº¼æŠŠä»–éš¨æ„æ‹†æˆå…©å€‹å­å­—ä¸²ï¼Œå·¦åŠé‚Šçš„å­—å…¸åºä¿è­‰å°æ–¼å³åŠé‚Šã€‚\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"æœ‰äº†é€™ä»¶äº‹æƒ…ä»¥å¾Œï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨ DFS ä¸€å€‹ä¸€å€‹å­—å…ƒæ±ºå®šã€‚é‚„è¨˜å¾— "},{"type":"element","tagName":"a","properties":{"href":"https://zh.wikipedia.org/wiki/%E5%85%8B%E5%8A%AA%E6%96%AF-%E8%8E%AB%E9%87%8C%E6%96%AF-%E6%99%AE%E6%8B%89%E7%89%B9%E7%AE%97%E6%B3%95"},"children":[{"type":"text","value":"KMP å­—ä¸²åŒ¹é…æ¼”ç®—æ³•"}]},{"type":"text","value":"å—ï¼Ÿæˆ‘å€‘åˆ©ç”¨ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[]"}]},{"type":"text","value":" é™£åˆ—æè¿°å°æ–¼æ‰€æœ‰å‰ç¶´å­—ä¸²ï¼Œèˆ‡ä¹‹åŒ¹é…çš„æœ€é•·å‰ç¶´å­å­—ä¸²ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"algorithm","properties":{},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"generator","properties":{},"children":[{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"        function*(input, ui) {\n            var S = input.S;\n            var n = S.length;\n            var last = [];\n            var i, j;\n            last.push(-1);\n            ui.setStyleOnce('arr', `0`, {fill: 'yellow'});\n              ui.setStyleOnce('S', `0`, {fill: 'yellow'});\n            for (i = 1; i < n; i++) {\n              yield {S: S, arr: last};\n              j = last[i-1]+1;\n              while (j > 0 && S[j] !== S[i])\n                j = last[j-1]+1;\n              last[i] = (S[i]===S[j]? j : -1)\n              for (var k = 0; k <= j; k++) {\n                ui.setStyleOnce('arr', `${i-k}`, {fill: 'lightyellow'});\n                ui.setStyleOnce('S', `${i-k}`, {fill: 'lightyellow'});\n              }\n              ui.setStyleOnce('arr', `${i}`, {fill: 'yellow'});\n              ui.setStyleOnce('S', `${i}`, {fill: 'yellow'});\n            }\n            return {S: S, arr: last};\n        }\n        "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"inputdata","properties":{"data":"{\"S\": \"aaabaaabaaabaabbaaabaabbb\"}"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"indirectdisplay","properties":{"array":"","fixedwidth":"","minwidth":"30","highlightdiff":"","varname":"S"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"indirectdisplay","properties":{"array":"","fixedwidth":"","n":"25","minwidth":"30","highlightdiff":"","varname":"arr"},"children":[]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"å¦‚æœè¼¸å…¥çš„å­—ä¸²æ˜¯ Lyndon wordï¼Œé‚£éº¼æˆ‘å€‘å¯ä»¥å¾—åˆ°å…©å€‹è§€å¯Ÿï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[]"}]},{"type":"text","value":" é™£åˆ—ï¼Œå¾å·¦åˆ°å³ä¸€æ—¦æœ‰æ•¸å­—è®Šå°ï¼Œæ°¸é æ˜¯å¾ $-1$ é–‹å§‹ï¼Œä¸æœƒå¾ä¸­é–“ç¹¼çºŒã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Lyndon word åšå‡ºä¾†çš„ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[]"}]},{"type":"text","value":" é™£åˆ—ï¼Œæœ€å¾Œä¸€å€‹ last å€¼æ°¸é æ˜¯ $-1$ã€‚"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"æ‰€ä»¥ DFS å°±å¾ˆç°¡å–®å•¦ï¼šæ¯æ¬¡æ±ºå®šåˆ°åº•ç¾åœ¨çš„ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[i]"}]},{"type":"text","value":" è¦ç­‰æ–¼ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[i-1]+1"}]},{"type":"text","value":" é‚„æ˜¯ç­‰æ–¼ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-1"}]},{"type":"text","value":"ã€‚å¦‚æœæ˜¯å‰è€…ï¼Œé‚£éº¼åªæœ‰ä¸€ç¨®é¸æ“‡ï¼Œå¦‚æœæ˜¯å¾Œè€…ï¼Œé‚£éº¼æ ¹æ“šã€Œåˆ†å…©åŠå­—å…¸åºå¿…é ˆæ¯”è¼ƒå¤§ã€çš„åŸå‰‡ï¼Œä¸‹ä¸€å€‹å€¼å¿…é ˆæ˜¯å¾ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"last[i-1]+1"}]},{"type":"text","value":" å°æ‡‰åˆ°çš„å­—å…ƒ"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"çš„ä¸‹ä¸€å€‹"}]},{"type":"text","value":"å¾€å¾Œé–‹å§‹è·³ã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"åƒè€ƒç¨‹å¼ç¢¼"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-cpp"]},"children":[{"type":"text","value":"#include <iostream>\n#include <vector>\nusing namespace std;\n\nstring s;\nint N, M, K;\nint current[100005];\nint a[10];\n\nstring get_string(int len) {\n  string ret = \"\";\n  for (int x = 0; x < len; x++)\n    ret += ('0' + a[current[x]]);\n  return ret;\n}\n\nvoid generate_lyndon_words(int now, int last) {\n  if (now && N%now == 0 && last == -1) {\n    s += get_string(now);\n  }\n\n  if (s.size() >= K+N-1) return;\n  if (now == N) return;\n\n  // é¸æ“‡å»¶çºŒ lastã€‚\n  if (now > 0) {\n    current[now] = current[last+1];\n    generate_lyndon_words(now+1, last+1);\n  }\n  // é¸æ“‡æŠŠ last æ›æˆ -1ï¼Œä½†æ˜¯ä½ çš„å­—å…¸åºè¦æ¯”åŸæœ¬çš„é‚„è¦å¤§ã€‚\n  for (int x = now? current[last+1]+1 : 0; x < M; x++) {\n    current[now] = x;\n    generate_lyndon_words(now+1, -1);\n  }\n}\n\nint main() {\n  cin >> N >> M >> K;\n  for (int i = 0; i < M; i++) cin >> a[i];\n  generate_lyndon_words(0, -1);\n  while (s.size() < K+N-1) s += s; // æŸç¨®é‚Šç•Œæ¢ä»¶...\n  s = s.substr(0, K+N-1);\n  cout << s << endl;\n  return 0;\n}\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"å‚™è¨»"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"å®˜æ–¹é¡Œè§£ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€ç¨®è§£æ³•çš„ä¸éœ€è¦ Hash ç‰ˆï¼Œåˆ†æˆå…©ç¨®æƒ…å½¢æ¢è¨ï¼š"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"$M^N\\le 2^{40}$ã€‚æ•´å€‹ de Bruijn Graph çš„é‚Šæ•¸ $= 2^{40}$ï¼Œä¹Ÿå°±æ˜¯èªªæ‰€æœ‰çš„é‚Šéƒ½å¯ä»¥ç›´æ¥ä»¥ $M$-é€²ä½è½‰æ›æˆ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"long long"}]},{"type":"text","value":" æ•¸å€¼ã€‚æ­¤æ™‚å¯ä»¥ç”¨ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"set<long long>"}]},{"type":"text","value":" ç›´æ¥å­˜èµ°è¨ªéçš„é‚Šã€‚"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"$M^N > 2^{40}$ã€‚æ­¤æ™‚ä½¿ç”¨ "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"random walk"}]},{"type":"text","value":" å¤§æ³•ï¼Œéš¨æ©Ÿç”¢ç”Ÿé•·åº¦ç‚º $K+N-1$ çš„åºåˆ—ï¼Œæœ‰å¾ˆé«˜çš„æ©Ÿç‡æœƒç”¢å‡ºä¸€å€‹åˆæ³•çš„ç­”æ¡ˆã€‚"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"é—œæ–¼ç«¶ç¨‹æ—¥è¨˜"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ğŸ… å¦‚æœæ‚¨æƒ³åˆ°æ›´å¤šæœ‰è¶£æ¼‚äº®ç°¡å–®ä¹¾æ·¨çš„è§£æ³•è©±æ­¡è¿ç•™è¨€çµ¦ç«¶ç¨‹æ—¥è¨˜å°ç·¨ç¾¤ï¼"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"â„¹ï¸ é€™æ˜¯ä¸€ç¯‡æŠ•ç¨¿çµ¦"},{"type":"element","tagName":"a","properties":{"href":"https://www.facebook.com/%E7%AB%B6%E7%A8%8B%E6%97%A5%E8%A8%98-1514973425463954/"},"children":[{"type":"text","value":"ç«¶ç¨‹æ—¥è¨˜"}]},{"type":"text","value":"çš„æ–‡ç« ï¼Œæ­¡è¿å¤§å®¶æŠ•ç¨¿ã€äº¤æµèˆ‡åˆ†äº«ç¨‹å¼è§£é¡Œç«¶è³½çš„é»é»æ»´æ»´ï¼"}]}],"data":{"quirksMode":false}},"frontmatter":{"date":"January 02, 2019","path":"/problem/icpc/asia_jakarta_2018/C","title":"Smart Thief","description":"Ayu æƒ³è¦æ‰“é–‹ä¸€å€‹ä½¿ç”¨å¯†ç¢¼é–åŠ å¯†çš„ç®±å­ã€‚ç‚ºäº†èƒ½å¤ æ‰¾å‡ºæ­£ç¢ºå¯†ç¢¼ï¼ŒAyu å¿…é ˆè¦å¾ˆéºæ†¾åœ°å˜—è©¦æ‰€æœ‰é•·åº¦ç‚º $N$ çš„å¯†ç¢¼çµ„åˆã€‚\n\næœ‰è¶£çš„æ˜¯ï¼ŒAyu ç™¼ç¾äº†é€™å¥—å¯†ç¢¼é–ç³»çµ±å…¶å¯¦ç›¸ç•¶å¤æ¿ï¼šç•¶ä½ è¼¸å…¥ $N$ å€‹æ•¸å­—ä»¥å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•åˆ¤æ–·ä½ åˆ°åº•è¼¸å…¥æ­£ç¢ºèˆ‡å¦ã€‚å¦‚æœè¼¸å…¥äº†æ­£ç¢ºçš„å¯†ç¢¼ï¼Œé‚£éº¼ç®±å­çš„é–ä¾¿æœƒæ‰“é–‹ã€‚åä¹‹ï¼Œå¦‚æœè¼¸å…¥äº†éŒ¯èª¤çš„å¯†ç¢¼ï¼Œé‚£éº¼ç³»çµ±æœƒå¾ˆè°æ˜åœ°æŠŠä½ å…ˆå‰è¼¸å…¥çš„ç¬¬ä¸€å€‹æ•¸å­—ï¼ˆæœ€æ—©çš„ï¼‰ä¸Ÿæ‰ï¼Œé€™éº¼ä¸€ä¾†ï¼Œä½ åªè¦å†è¼¸å…¥ä¸€å€‹æ•¸å­—å°±å¯ä»¥è®“ä»–è®Šæˆé•·åº¦ $N$ äº†ã€‚\n\nèˆ‰ä¾‹ä¾†èªªï¼Œå¦‚æœ $N=4$ï¼Œè€Œä¸” Ayu ä¾åºè¼¸å…¥äº† `204320435`ï¼Œé‚£éº¼ç³»çµ±å¯¦éš›ä¸Šæœƒæª¢æ¸¬ 6 æ¬¡ï¼ˆå…±æœ‰ 5 ç¨®ä¸åŒçš„ PINï¼‰ï¼š\n\n* `2043`\n* `0432`\n* `4320`\n* `3204`\n* `2043`\n* `0435`\n\nAyu æƒ³è¦åœ¨ç¬¬ä¸€å¤©æ¸¬è©¦ $K$ ç¨®ä¸åŒçš„å¯†ç¢¼ã€‚ä½ èƒ½ä¸èƒ½æ‰¾å‡ºä»»ä½•ä¸€å€‹é•·åº¦æœ€çŸ­çš„å­—ä¸² $S$ï¼Œä½¿å¾—å®ƒå¯ä»¥è®“æ©Ÿå™¨æª¢æ¸¬åˆ°ä»»æ„ $K$ å€‹ä¸åŒçš„å¯†ç¢¼å‘¢ï¼Ÿé€™å€‹å¤è€çš„ç³»çµ±èƒ½å¤ éµå…¥çš„æ•¸å­—ç¨®é¡æœ‰é™ï¼šå®ƒå€‘æœƒæ˜¯ `0` åˆ° `9` é€™äº›æ•¸å­—ä¸­çš„æŸ $M$ å€‹ã€‚\n","roadmap_label_h3":null,"backlink":"/icpcblog-weekly-2019","css_title_theme":null,"css_content_theme":null,"math_font":null}}},"pageContext":{}},"staticQueryHashes":["1470849938","511501522"]}