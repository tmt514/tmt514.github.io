{"data":{"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"簡化後題目敘述"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"showvariable","properties":{"varname":"description"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"輸入說明"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"第一列有一個正整數 $Q$ ($1\\le Q\\le 3\\cdot 10^6$)。接下來的 $Q$ 列每一列有一個正整數 $i$ ($2\\le i\\le 2\\cdot 10^6$)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"輸出說明"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"對每個詢問輸出答案於一行。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸入 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"4\n100\n13\n12\n2018\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸出 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"7\n1\n4\n2\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"OJ 連結"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://open.kattis.com/problems/nonprimefactors"},"children":[{"type":"text","value":"Open Kattis - Non-Prime Factors"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"題目出處"}]},{"type":"text","value":"：ICPC 2018 Asia Singapore Regional"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"解法"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"計算總因數個數減去質因數個數就行啦。一般來說直接用篩法是 $O(N\\log\\log N)$ 時間"},{"type":"element","tagName":"footnote","properties":{"goto":"1","show":"備註1"},"children":[]},{"type":"text","value":"，所以已經很足夠了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在假設乘除法都是 $O(1)$ 的情形下（但可以證明 bit 數量不固定時，計算乘除必須要 $\\omega(1)$ 的時間，所以理論上乘除法不應該被視為常數。）下面程式碼範例使用的是線性時間的篩法 $O(N)$。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"參考程式碼"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"快速 I/O 感覺真的滿重要的。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-cpp"]},"children":[{"type":"text","value":"#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 2000005;\nvector<int> primes;\nint almost_factors[N];\nint prime_factors[N];\nint min_power[N];\nint min_prime[N];\n\nchar s[32];\nvoid ReadInt(int &x) {\n  x = 0;\n  fgets(s, 32, stdin);\n  for (int i=0;s[i] >= '0';i++) {\n    x=x*10+s[i]-'0';\n  }\n}\n\nstring output;\nvoid WriteBuffer(int y) {\n  if (output.size()) output += '\\n';\n  output += to_string(y);\n}\n\nint main() {\n  for (int i = 2; i < N; i++) {\n    if (prime_factors[i] == 0) {\n      primes.push_back(i);\n      almost_factors[i] = 1;\n      prime_factors[i] = 1;\n      min_power[i] = 1;\n      min_prime[i] = i;\n    }\n    for (int j = 0; i * primes[j] < N; j++) {\n      int p = primes[j];\n      if (p != min_prime[i]) {\n        almost_factors[i * p] = almost_factors[i] * (min_power[i]+1);\n        prime_factors[i * p] = prime_factors[i] + 1;\n        min_power[i * p] = 1;\n        min_prime[i * p] = p;\n      } else {\n        almost_factors[i * p] = almost_factors[i];\n        prime_factors[i * p] = prime_factors[i];\n        min_power[i * p] = min_power[i] + 1;\n        min_prime[i * p] = min_prime[i];\n        break;\n      }\n    }\n  }\n\n  int Q, x;\n  //ios_base::sync_with_stdio(false);\n  //cin.tie(NULL);\n  //cin >> Q;\n  ReadInt(Q);\n  while (Q--) {\n    ReadInt(x);\n    WriteBuffer(almost_factors[x] * (min_power[x]+1) - prime_factors[x]);\n  }\n  puts(output.c_str());\n  return 0;\n}\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"備註 1"},{"type":"element","tagName":"footnote","properties":{"here":"1"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"關於篩法的時間複雜度之超單純證明，請容許我自肥一下，請參考以下連結："},{"type":"element","tagName":"a","properties":{"href":"https://tmt514.github.io/competitive-programming/2017/11/17/elementary-proof-on-analysis-of-eratosthenes-sieve.html"},"children":[{"type":"text","value":"https://tmt514.github.io/competitive-programming/2017/11/17/elementary-proof-on-analysis-of-eratosthenes-sieve.html"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"關於競程日記"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"🍅 如果您想到更多有趣漂亮簡單乾淨的解法話歡迎留言給競程日記小編群！"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ℹ️ 這是一篇投稿給"},{"type":"element","tagName":"a","properties":{"href":"https://www.facebook.com/%E7%AB%B6%E7%A8%8B%E6%97%A5%E8%A8%98-1514973425463954/"},"children":[{"type":"text","value":"競程日記"}]},{"type":"text","value":"的文章，歡迎大家投稿、交流與分享程式解題競賽的點點滴滴！"}]}],"data":{"quirksMode":false}},"frontmatter":{"date":"January 19, 2019","path":"/problem/icpc/asia_singapore_2018/L","title":"Non-Prime Factors","description":"給你 $Q$ 個正整數，對於每一個正整數 $n$，請你回答 $n$ 有多少個非質數的因數？\n","roadmap_label_h3":null,"backlink":"/icpcblog-weekly-2019"}}},"pageContext":{}}