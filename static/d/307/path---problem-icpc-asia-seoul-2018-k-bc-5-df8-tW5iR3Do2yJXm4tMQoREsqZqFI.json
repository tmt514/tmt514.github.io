{"data":{"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"簡化後題目敘述"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"showvariable","properties":{"varname":"description"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"輸入說明"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"第一列包含兩個正整數 $k, n$ ($3 < k\\le 5000, 1\\le n\\le 10000$)。第二列開始每一列包含三個形如 $(l, c)$ 的條件，皆以空白隔開。（$1\\le l \\le k, c\\in \\set{{\\tt R}, {\\tt B}}$）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"輸出說明"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果存在一個可行解，請輸出一個長度為 $k$ 的字串，其中第 $i$ 個字元代表了第 $i$ 盞燈的顏色。若不存在解的話請輸出 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-1"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸入 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"7 5\n3 R 5 R 6 B\n1 B 2 B 3 R\n4 R 5 B 6 B\n5 R 6 B 7 B\n1 R 2 R 4 R\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸出 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"BRRRBBB\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸入 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"5 6\n1 B 3 R 4 B\n2 B 3 R 4 R\n1 B 2 R 3 R\n3 R 4 B 5 B\n3 B 4 B 5 B\n1 R 2 R 4 R\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"範例輸出 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-1\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"OJ 連結"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://codeforces.com/gym/101987"},"children":[{"type":"text","value":"Codeforces Gym"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"題目出處"}]},{"type":"text","value":"：ICPC 2018 Asia Seoul Regional"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"解法"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"這個問題乍看之下非常的 "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Boolean_satisfiability_problem"},"children":[{"type":"text","value":"3-SAT"}]},{"type":"text","value":"，但是多了「至少要滿足兩個以上」這個條件後，這個問題變成了 MAJ-3-SAT。而加強了條件的 MAJ-3-SAT 問題可以輕鬆轉化成 "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/2-satisfiability"},"children":[{"type":"text","value":"2-SAT"}]},{"type":"text","value":" 的問題，於是能在多項式（線性）時間內解掉。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"（廣義版的 MAJ-SAT，即不限定每一個要求內含的條件數量。這個問題是 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"PP"}]},{"type":"text","value":"-complete 的。按照 "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/PP_(complexity)"},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"PP"}]}]},{"type":"text","value":" 的定義來看，它同時包含了 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"NP"}]},{"type":"text","value":" 以及 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"co-NP"}]},{"type":"text","value":"，因此難度看起來比一般的 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SAT"}]},{"type":"text","value":" 還高。但意外有趣的是，MAX-3-SAT 簡單很多。）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"對於每一個要求 $(\\text{條件一} \\lor \\text{條件二}\\lor\\text{條件三})$，如果得滿足至少兩個條件的話，就會完全等價於拆成三個至少滿足一個條件的要求："}]},{"type":"text","value":"\n$$\n(\\text{條件一} \\lor \\text{條件二})\\land (\\text{條件二}\\lor\\text{條件三}) \\land (\\text{條件三}\\lor\\text{條件一})\n$$\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"於是，我們就可以利用一般解決 "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/2-satisfiability"},"children":[{"type":"text","value":"2-SAT"}]},{"type":"text","value":" 的演算法（建立一個"},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Implication_graph"},"children":[{"type":"text","value":"關聯圖 Implication Graph"}]},{"type":"text","value":"，然後計算"},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Strongly_connected_component"},"children":[{"type":"text","value":"強連通元件 Strongly Connected Component"}]},{"type":"text","value":"，然後再用貪求法找出一組解。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"參考程式碼"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"下面我們使用 "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Kosaraju%27s_algorithm"},"children":[{"type":"text","value":"Kosaraju 演算法"}]},{"type":"text","value":" 計算強連通元件"},{"type":"element","tagName":"footnote","properties":{"goto":"1","show":"備註1"},"children":[]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-cpp"]},"children":[{"type":"text","value":"#include <bits/stdc++.h>\nusing namespace std;\n\nclass Graph {\npublic:\n  int n;\n  vector<vector<int>> adj;\n  vector<vector<int>> rev;\n  vector<int> scc;\n  vector<int> visited;\n  vector<vector<int>> groups;\n  int nscc;\n  Graph(int _n) : n(_n) {\n    adj.resize(n);\n    rev.resize(n);\n    visited.resize(n, 0);\n    scc.resize(n, 0);\n    groups.resize(n+1);\n    nscc = 0;\n  }\n  void AddEdge(int x, int y) {\n    adj[x].push_back(y);\n    rev[y].push_back(x);\n  }\n  void ComputeSCC() {\n    vector<int> stack;\n    for (int i = 0; i < n; i++)\n      if (visited[i] == 0)\n        _dfs1(stack, i);\n    while (!stack.empty()) {\n      int x = stack.back();\n      stack.pop_back();\n      if (visited[x] == 1) {\n        ++nscc;\n        _dfs2(x);\n      }\n    }\n  }\n\nprivate:\n  void _dfs1(vector<int> &stack, int x) {\n    visited[x] = 1;\n    for (int y : adj[x])\n      if (visited[y] == 0)\n        _dfs1(stack, y);\n    stack.push_back(x);\n  }\n  void _dfs2(int x) {\n    visited[x] = 2;\n    scc[x] = nscc;\n    groups[nscc].push_back(x);\n    for (int y : rev[x])\n      if (visited[y] == 1)\n        _dfs2(y);\n  }\n};\n\nint ReadNode() {\n  int l;\n  string c;\n  cin >> l >> c;\n  return l * 2 + (c[0] == 'R');\n}\n\nint main() {\n  int k, n;\n  cin >> k >> n;\n  Graph g(k * 2 + 10);\n  for (int i = 0; i < n; i++) {\n    int x[4];\n    for (int j = 0; j < 3; j++)\n      x[j] = ReadNode();\n    x[3] = x[0];\n    for (int j = 0; j < 3; j++) {\n      g.AddEdge(x[j] ^ 1, x[j + 1]);\n      g.AddEdge(x[j + 1] ^ 1, x[j]);\n    }\n  }\n  g.ComputeSCC();\n\n  // 判斷是否無解。\n  for (int i = 1; i <= k; i++) {\n    if (g.scc[i * 2] == g.scc[i * 2 + 1]) {\n      cout << \"-1\" << endl;\n      return 0;\n    }\n  }\n\n  // 從縮圖之後從相依順序末端開始，以貪求法找出一組 2-SAT 解。\n  vector<bool> taken(g.n, false);\n  for (int scc = g.nscc; scc > 0; scc--) {\n    bool ok = true;\n    for (int x : g.groups[scc])\n      if (taken[x ^ 1])\n        ok = false;\n    if (ok) {\n      for (int x : g.groups[scc])\n        taken[x] = true;\n    }\n  }\n\n  // 把解答輸出。\n  string ret = \"\";\n  for (int i = 1; i <= k; i++) {\n    if (taken[i * 2] == true) {\n      ret += \"B\";\n    } else {\n      ret += \"R\";\n    }\n  }\n\n  cout << ret << endl;\n  return 0;\n}\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"備註 1"},{"type":"element","tagName":"footnote","properties":{"here":"1"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"教育部的雙語對照辭典把 Strongly Connected Component 翻譯成"},{"type":"element","tagName":"a","properties":{"href":"http://terms.naer.edu.tw/detail/2426323/?index=2"},"children":[{"type":"text","value":"強連接組件"}]},{"type":"text","value":"，真的很工程噎。我一直在思考到底是強連通元件、強連通分量、還是強連通分支，原來還漏了強連接系列呀（嘆）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"關於競程日記"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"🍅 如果您想到更多有趣漂亮簡單乾淨的解法話歡迎留言給競程日記小編群！"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ℹ️ 這是一篇投稿給"},{"type":"element","tagName":"a","properties":{"href":"https://www.facebook.com/%E7%AB%B6%E7%A8%8B%E6%97%A5%E8%A8%98-1514973425463954/"},"children":[{"type":"text","value":"競程日記"}]},{"type":"text","value":"的文章，歡迎大家投稿、交流與分享程式解題競賽的點點滴滴！"}]}],"data":{"quirksMode":false}},"frontmatter":{"date":"January 23, 2019","path":"/problem/icpc/asia_seoul_2018/K","title":"TV Show Game","description":"舞台上有 $k$ （$k\\ge 3$）盞燈，每一盞燈可以設定成紅色 `R` 或藍色 `B`。現在有 $n$ 個要求：每一個要求內容都包含三個條件，每個條件都以 $(l, c)$ 表示，代表第 $l$ 盞燈設定為顏色 $c$。只要滿足兩個以上的條件，就算滿足了該要求。\n\n若存在一組設定燈的顏色的方法，請輸出任何一組解。否則輸出 `-1`。\n","roadmap_label_h3":null,"backlink":"/icpcblog-weekly-2019"}}},"pageContext":{}}