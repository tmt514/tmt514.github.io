{"data":{"markdownRemark":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"剩餘網路 Residual Networks"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"要討論網路流，就必須要討論剩餘網路（residual networks）。如果我們在圖 $G$ 上面有一個流 $f$，那我們可以定義一個剩餘網路 $G_f$，代表有哪些地方還有空間推進更多的網路流。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最小費用流在剩餘網路上會長什麼樣子呢？很幸運地，Klein 在 1967 年為我們證明了以下定理："}]},{"type":"element","tagName":"theorem","properties":{"title":"負圈定理"},"children":[{"type":"text","value":"\n$f$ 是最佳解若且唯若 $G_f$ 上面定義 cost 為權重時，不存在一個負圈。\n"}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"證明"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"$\\Rightarrow$\":"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n如果 $G_f$ 上面存在一個負圈，那麼沿著這個負圈增廣，會得到總花費更小的解，與 $f$ 最佳解的假設矛盾。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"$\\Leftarrow$\":"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n如果 $f$ 不是最佳解，那我們考慮真正的最佳解 $f^\\star$。考慮兩個解的差異 $f'=f^\\star - f$，不難推敲得知 $f'$ 的所有邊都會出現在 $G_f$ 上面。由於 $f'$ 是一個可行流，我們可以將 $f'$ 拆成許多圈的疊加。但是因為 $cost(f')$ 帶來的總花費是負的（因為 $cost(f') = cost(f^\\star) - cost(f) < 0$），所以至少有一個圈帶來的花費也是負的。得證。"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"消圈演算法 Cycle Cancellation Algorithms"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"這個演算法是由 Klein [1967] 從 Ford-Fulkerson 網路流演算法得來的想法，以迭代的方式不斷地更新當前找到的解，直到滿足最佳解條件為止。"},{"type":"element","tagName":"sup","properties":{"id":"fnref-2"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fn-2","className":["footnote-ref"]},"children":[{"type":"text","value":"2"}]}]}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"f = 空的網路流\nwhile 剩餘網路 G_f 上面存在負圈:\n    令 C 為任何一個負圈\n    令 Δ 為這個負圈上能推的最大流量\n    更新 f = f + CΔ\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"時間複雜度"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如同 Ford-Fulkerson 演算法一般，在所有 cost 和 capacity 都是整數的時候，每一次消圈，只能夠保證總花費至少降低了 1 單位。顯然最小的總花費值比 $-mCU$ 來得大，所以我們可以得知迭代消圈的次數至多為 $O(mCU)$。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"而找負圈的演算法則可以使用 Bellman-Ford 演算法，所需時間為 $O(nm)$。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"因此整體的時間複雜度是 $O(nm^2CU)$，由於 $C$ 和 $U$ 僅是數值，相對於輸入規模而言是指數級別的，在數值較大時效率不甚理想。"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"更快的消圈算法"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"最小均值圈"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"結論"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"演算法"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"消圈的次數"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"每一次消圈的時間"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Weakly-Polynomial Worst-Case Complexity"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Strongly-Polynomial Worst-Case Complexity"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Goldberg and Tarjan [1989]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次消最小均值圈"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm \\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^2m^2\\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^2m^3)$"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Goldberg and Tarjan [1989]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次找所有簡化邊權重為負的圈"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm \\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm\\log n\\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm^2\\log^2n)$"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Barahona and Tardos [1989]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次找一票點不重複的負圈然後增廣"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m \\log (nCU))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm+n^2\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O((nm^2+mn^2\\log n)\\log(nCU)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"N/A"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Rock [1991]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次找剩餘流量足夠大的負圈"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m \\log U)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm)$ 或 $O(m+n\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm^2\\log U)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"N/A"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Wallacher [1991]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次找最負比重負圈"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m \\log (nCU))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^3\\log^2 n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^3m\\log^2 n\\log(nCU))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"N/A"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Shigeno, Iwata and McCormick [1996]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"最負圈鬆弛演算法"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm \\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm+n^2\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^2m^2\\log (nC)$ $+$ $n^3m\\log n\\log (nC))$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(n^2m^3\\log n$ $+$ $n^3m^2\\log n)$"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Shigeno, Iwata and McCormick"},{"type":"element","tagName":"sup","properties":{"id":"fnref-3"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fn-3","className":["footnote-ref"]},"children":[{"type":"text","value":"3"}]}]},{"type":"text","value":" [1996]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"最負圈縮放代價演算法"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm \\log C)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(nm\\log C \\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"N/A"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"Sokkalingam, Ahuja and Orlin [1997]"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"每次找剩餘流量足夠大的負圈"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m \\log C)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m+n\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m^2\\log C$ $+$ $nm\\log C\\log n)$"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"$O(m^3\\log n$ $+$ $nm^2\\log^2 n)$"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"small","properties":{},"children":[{"type":"text","value":"資料來源： Sokkalingam, Ahuja, Orlin, "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"New Polynomial-Time Cycle-Cancelling Algorithms for Minimum Cost Flows"}]},{"type":"text","value":", 1997. "},{"type":"element","tagName":"sup","properties":{"id":"fnref-1"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fn-1","className":["footnote-ref"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"參考資料"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["footnotes"]},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{"id":"fn-1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://pdfs.semanticscholar.org/f799/350ee4b93f02e672157d54ee06849edb7355.pdf"},"children":[{"type":"text","value":"Sokkalingam, Ahuja, Orlin, "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"New Polynomial-Time Cycle-Cancelling Algorithms for Minimum Cost Flows"}]},{"type":"text","value":", 1997."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"a","properties":{"href":"#fnref-1","className":["footnote-backref"]},"children":[{"type":"text","value":"↩"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{"id":"fn-2"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www2.cs.duke.edu/courses/fall15/cps232/scribe_notes/lec05.pdf"},"children":[{"type":"text","value":"Duke University COMPSCI532 Fall 2015 Scribe Notes"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"a","properties":{"href":"#fnref-2","className":["footnote-backref"]},"children":[{"type":"text","value":"↩"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{"id":"fn-3"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.jstor.org/stable/3690424?seq=1"},"children":[{"type":"text","value":"Shigeno, Iwata and McCormick, "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Relaxed Most Negative Cycle and Most Positive Cut Canceling Algorithms for Minimum Cost Flow"}]},{"type":"text","value":", Mathematics of Operations Research 2000"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"a","properties":{"href":"#fnref-3","className":["footnote-backref"]},"children":[{"type":"text","value":"↩"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]}]},"frontmatter":{"date":"November 20, 2018","path":"/algo/min-cost-max-flow-cycle-cancellation","title":"最小費用流的消圈演算法","description":null}}},"pageContext":{}}